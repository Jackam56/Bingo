<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="description" content="I-75 Bingo - The ultimate road trip game for travelers on Interstate 75">
    <meta name="theme-color" content="#667eea">
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIkktNzUgQmluZ28iLAogICJzaG9ydF9uYW1lIjogIkk3NUJpbmdvIiwKICAic3RhcnRfdXJsIjogIi8iLAogICJkaXNwbGF5IjogInN0YW5kYWxvbmUiLAogICJ0aGVtZV9jb2xvciI6ICIjNjY3ZWVhIiwKICAiYmFja2dyb3VuZF9jb2xvciI6ICIjNzY0YmEyIiwKICAiaWNvbnMiOiBbCiAgICB7CiAgICAgICJzcmMiOiAiZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFNQUFBQURBQ0FZQUFBQ0F3M0MwQUFBQUVsRVFWUjRYdVdZeVFyRE1Bek5Nb0pIOCtzRUFBQUFBQUVsRlRrU3VRbUNDIiwKICAgICAgInNpemVzIjogIjE5MngxOTIiLAogICAgICAidHlwZSI6ICJpbWFnZS9wbmciCiAgICB9LAogICAgewogICAgICAic3JjIjogImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBZ0FBQUFJQUNBWUFBQUNBZ0ozeUFBQUFFbEVRVlI0WXVXWXlRckRNQXpOTW9KSDgrc0VBQUFBQUVsRlRrU3VRbUNDIiwKICAgICAgInNpemVzIjogIjUxMng1MTIiLAogICAgICAidHlwZSI6ICJpbWFnZS9wbmciCiAgICB9CiAgXQp9">
    <link rel="apple-touch-icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAAAAB3RJTUUH5QwbDjsI0qCKLgAAIABJREFUeNrtnXd4W+d5rp8PBBdIS5ZkWbJly3Y6bCdOOp000rZpE6tNOqbTZCfpOU3bM5r0nOGc1pl4xHGGZVm2JMu2JNuyJVuybMmSJEuibInCIkiQGAQBEhxvf7j+/wEQBAACSzwA7/W8/I8OQR4CeL/3+++555xzjhEAAAAAAAAAAOCOiNLLnp1/+5H/+a1veOQ7XT/RoAABAABAfNDrdOrWtramZ5999vnly5evXbhw4aw1p9c5J0e3i6Gho/Pz81PWJc1WfVdP+e3bty1j6ykQAAAAAJAIjEYjO3/+vObJJ5988vHPfnZf0zeu/FXz9Og7tW9dTa85cfKx3z/8u09+ecc4qbJutAZUKjg9/f2dk8L62dlZTSAQsHxdOwAAAIA4Z3p6Wu3S/3+nYWdTy7cf3HWXSE37s+5v7whe95s69HxH+IU+zcK4UXPN+bN7dp7cdOPsyb0H9m59+g+ffOoP+vv6PzY7N/sny7c/8je9vb1v8r4jjY2Nr3I+/wYCAAAAcYfT6VStrKw03bp1q2VmZubD3tde/KbJbfrV5XdW/vfImWt/pLzh/qX+w4Xfr3X+fP+Pjh/qe/f/3NLz2tFP7f3k3ldfvdW79Obp17/16muHnnnm2acej+ep3/3d3/lnzvE/Xbly5U/ffPPNR7mNz/K6H+V9W9kN/I+bN2/+5bXr1z/1zjvvfJ3z/hgIAAAAxAUOh8Pf0dGheuWVV/7xww8/vEvYh74sfEfeU3FpZ+Xg6J+7XvddYTvyxuH9x7+57bM7fjqgU8P6T772jfve2Pq1fS/t/syO/2iYHfqL1Xv/8u9aWlpe5PzPkZGRf2lsbPzRO++888nXX3/9r998880/5D7O/9jt9r/geH+ec/+fd+/e/cPu7u7v8DwvPfzwwzc4j/81a0ynQQAAAIgLampqFB/72Mde+e53v/stZ9/s2863O35p7B7/eePIyB+J78yJk//xxOGTn/9i7+FdX6q/+ujXd9zziP77O5/Z8/OeO1aDzrDsJ62trb9y7979X+M+Pm1tbf3e0NDQ/66vr1eWlZUNlZSUPHX27Nlfef311//8+vXrX+nr6/txd3f3fxcUFPzK7t27f8nz/xvO8ac2m+1PmpqaXgQBAACIWT766KOEL2T5j8nJyXvGJ6afcp87/6XJd7q+tnhz9M/buvr+m1ywOTc39/TBgwfnWltbX2xoaPjJO++8809ff/31v37uuef++le/+tWXzp49+7erq6vfmJub+9fR0dEfcR8/4t3+y23P3t/5DxubEAMAABB3CCUCCr9ArXamgv1y1b6X9n/q0Q8lJSW/mJmZ+Y9f/vKX3+Jef4v3//9y7nkbgfCJ0X/4/wkEI3/8F8Y1m10BAAAAgNshhAQsdjdNO0fJaDPT5Io9/N9m12ZP4TYAAAAAAIC7YQsAWAAyaE4yOG8TAAAA4AlbAMACcP4dEJYHAADgCVsAwAJw/iUobA8AAMAXtgCABRCBhDYAAIDLYAsAWAARSGgDAAC4DLYAgAUQgYQ2AACAG2ALAFgAEUhoAwAAuA22AIAFEIGENgAAgBtgCwBYABFIaAMAAPCFLQBgAUQgoQ0AAOAGGAwGywLwQ0IbAADAF7YAgAUQgYQ2AACAW2ALAFgAEUhoAwAAuAG2AIAFEIGENgAAgBtgCwBYABFIaAMAAPCFLQBgAUQgoQ0AAOAGGDCwLICZyUpGh8Xj/DsAAIAtAAALwBe2AAAAQKyDLQCw+aRDIZrWr9LKitX6fw8AALABAAAAbAoIAAAAYBNAAAAAAJsAAgAAANgEEAAAAMAmgAAAAA0AQ2gAAACbEHCvLQAAGwCG0AAAADYByNZBwFo=">
    <title>I-75 Bingo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            overflow-x: hidden;
            user-select: none;
            -webkit-user-select: none;
            -webkit-touch-callout: none;
            min-height: 100vh;
        }

        .app-container {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 8px;
            max-width: 100vw;
        }

        .header {
            text-align: center;
            margin: 10px 0 15px 0;
            width: 100%;
        }

        .header h1 {
            font-size: clamp(1.5rem, 5vw, 2.5rem);
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            margin-bottom: 8px;
        }

        .timer-display {
            font-size: clamp(1rem, 3.5vw, 1.5rem);
            font-weight: bold;
            background: rgba(0,0,0,0.3);
            padding: 8px 16px;
            border-radius: 20px;
            margin-bottom: 15px;
            min-width: 120px;
            display: inline-block;
        }

        .button-container {
            display: flex;
            gap: 8px;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 15px;
            width: 100%;
            max-width: 500px;
        }

        .play-button, .new-card-button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 16px;
            font-size: clamp(0.9rem, 2.5vw, 1.1rem);
            border-radius: 20px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
            flex: 1;
            min-width: 100px;
            max-width: 140px;
        }

        .new-card-button {
            background: #2196F3;
            position: relative;
            overflow: hidden;
        }

        .play-button:hover, .new-card-button:hover {
            transform: translateY(-2px);
        }

        .play-button:disabled, .new-card-button:disabled {
            background: #666 !important;
            cursor: not-allowed;
            transform: none;
        }

        #newCardButton::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: 100%;
            background: linear-gradient(90deg, #F44336 0%, #FFC107 100%);
            transition: width 1s linear;
            z-index: 1;
        }

        #newCardButton span {
            position: relative;
            z-index: 3;
        }

        #newCardButton:disabled::before {
            display: none;
        }

        .bingo-card {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 2px;
            width: min(95vw, 480px);
            max-width: 480px;
            background: rgba(0,0,0,0.2);
            padding: 8px;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
            margin: 0 auto;
        }

        .bingo-square {
            aspect-ratio: 1;
            background: white;
            color: #333;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-size: 0.9rem !important;
            font-weight: bold !important;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            padding: 3px;
            border: 2px solid transparent;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            position: relative;
            line-height: 1.2 !important;
            overflow: hidden;
        }

        /* Mobile-first approach with explicit sizing */
        @media screen and (max-width: 480px) {
            .bingo-square {
                font-size: 0.75rem !important;
                font-weight: bold !important;
                line-height: 1.1 !important;
            }
        }

        @media screen and (max-width: 400px) {
            .bingo-square {
                font-size: 0.7rem !important;
                font-weight: bold !important;
            }
        }

        /* Larger font size for short phrases */
        .bingo-square.short-phrase {
            font-size: 1.1rem !important;
        }

        @media screen and (max-width: 480px) {
            .bingo-square.short-phrase {
                font-size: 0.9rem !important;
            }
        }

        @media screen and (max-width: 400px) {
            .bingo-square.short-phrase {
                font-size: 0.85rem !important;
            }
        }

        @media screen and (max-width: 360px) {
            .bingo-square.short-phrase {
                font-size: 0.8rem !important;
            }
        }

        /* Special styling for emergency vehicle */
        .bingo-square.emergency-style {
            font-size: 0.9em !important;
            padding: 0px !important;
        }

        .bingo-square.emergency-style span {
            padding: 0px !important;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        .bingo-square.emergency-style .emergency-word {
            font-size: 1em;
            font-weight: 900 !important;
        }

        .bingo-square.emergency-style .vehicle-word {
            font-size: 1.15em;
            font-weight: 900 !important;
        }

        /* Mobile adjustments for emergency vehicle */
        @media screen and (max-width: 480px) {
            .bingo-square.emergency-style {
                font-size: 0.6em !important;
            }
            
            .bingo-square.emergency-style span {
                gap: 4px;
            }
        }

        @media screen and (max-width: 360px) {
            .bingo-square.emergency-style {
                font-size: 0.55em !important;
            }
            
            .bingo-square.emergency-style span {
                gap: 3px;
            }
        }

        /* Special styling for motorcyclist */
        .bingo-square.motorcyclist-style {
            padding: 0px !important;
        }

        .bingo-square.motorcyclist-style span {
            padding: 0px !important;
        }

        /* Special styling for programmable road sign */
        .bingo-square.programmable-style {
            font-size: 0.65em !important;
            padding: 1px !important;
            line-height: 1.1 !important;
        }

        .bingo-square.programmable-style span {
            padding: 1px !important;
            line-height: 1.1 !important;
            font-weight: 900 !important;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        .bingo-square.programmable-style .smaller-word {
            font-size: 0.9em;
            font-weight: 900 !important;
        }

        .bingo-square.programmable-style .normal-word {
            font-size: 1.25em;
            font-weight: 900 !important;
        }

        /* Mobile adjustments for programmable style */
        @media screen and (max-width: 480px) {
            .bingo-square.programmable-style {
                font-size: 0.6em !important;
                line-height: 1.0 !important;
            }
            
            .bingo-square.programmable-style span {
                line-height: 1.0 !important;
            }
        }

        @media screen and (max-width: 360px) {
            .bingo-square.programmable-style {
                font-size: 0.55em !important;
                line-height: 0.95 !important;
            }
            
            .bingo-square.programmable-style span {
                line-height: 0.95 !important;
            }
        }

        /* Special styling for side x side ORV - reduced padding */
        .bingo-square.side-x-side-style {
            padding: 0px !important;
        }

        .bingo-square.side-x-side-style span {
            padding: 0px !important;
        }

        /* Special styling for duck hunting boat */
        .bingo-square.duck-hunting-style {
            font-size: 0.9em !important;
            padding: 0px !important;
        }

        .bingo-square.duck-hunting-style span {
            padding: 0px !important;
            font-weight: 900 !important;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 2px;
        }

        .bingo-square.duck-hunting-style .duck-word {
            font-size: 1em;
            font-weight: 900 !important;
        }

        /* Special styling for semi cab - reduced padding */
        .bingo-square.semi-cab-style {
            padding: 0px !important;
            font-size: 0.85em !important;
        }

        .bingo-square.semi-cab-style span {
            padding: 0px !important;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 2px;
        }

        .bingo-square.semi-cab-style .semi-line {
            font-size: 1em;
            font-weight: 900 !important;
            white-space: nowrap;
        }

        /* Special styling for semi cab - reduced padding */
        .bingo-square.semi-cab-style {
            padding: 0px !important;
            font-size: 0.85em !important;
        }

        .bingo-square.semi-cab-style span {
            padding: 0px !important;
            margin: 0px !important;
            text-indent: 0px !important;
            white-space: pre-line !important;
            word-spacing: -2px !important;
            letter-spacing: -0.5px !important;
        }

        @media screen and (max-width: 480px) {
            .bingo-square.semi-cab-style {
                font-size: 0.8em !important;
            }
        }

        @media screen and (max-width: 360px) {
            .bingo-square.semi-cab-style {
                font-size: 0.75em !important;
            }
        }

        .bingo-square::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.75);
            border-radius: 4px;
            z-index: 1;
        }

        .bingo-square span {
            position: relative;
            z-index: 2;
            text-shadow: 1px 1px 3px rgba(255, 255, 255, 0.9);
            word-break: break-word;
            hyphens: auto;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            width: 100%;
            height: 100%;
            padding: 2px;
            font-weight: bold !important;
            font-size: inherit !important;
            line-height: inherit !important;
        }

        .bingo-square:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .bingo-square.selected::before {
            background: rgba(76, 175, 80, 0.85);
        }

        .bingo-square.selected span {
            color: white;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }

        .bingo-square.free::before {
            background: rgba(76, 175, 80, 0.85);
        }

        .bingo-square.free span {
            color: white;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }

        .bingo-square.pre-game {
            pointer-events: none;
            cursor: default;
        }

        .bingo-square.pre-game::before {
            background: rgba(100, 100, 100, 0.95) !important;
        }

        .bingo-square.pre-game span {
            opacity: 0 !important;
            visibility: hidden !important;
        }

        .bingo-square.pre-game::after {
            content: '?';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 3;
            color: white;
            font-size: clamp(1.2rem, 4vw, 2rem);
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .bingo-square.free.pre-game::after {
            content: 'FREE';
            font-size: clamp(0.7rem, 2.5vw, 1rem);
        }

        .bingo-square.disabled {
            pointer-events: none;
            opacity: 0.7;
            cursor: default;
        }

        .bingo-square.disabled:hover {
            transform: none;
            box-shadow: none;
        }

        .bingo-square.free.hold-to-pause {
            border: 3px solid #FFC107;
            box-shadow: 0 0 20px rgba(255, 193, 7, 0.8);
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes bingo-blink {
            0% { background-color: rgba(76, 175, 80, 0.85); }
            50% { background-color: rgba(255, 193, 7, 0.9); }
            100% { background-color: rgba(76, 175, 80, 0.85); }
        }

        @keyframes rapid-flash {
            0% { background-color: rgba(76, 175, 80, 0.85); }
            25% { background-color: rgba(255, 0, 0, 0.9); }
            50% { background-color: rgba(0, 0, 255, 0.9); }
            75% { background-color: rgba(255, 0, 255, 0.9); }
            100% { background-color: rgba(0, 255, 255, 0.9); }
        }

        .bingo-square.bingo-winner::before {
            animation: bingo-blink 0.5s infinite;
        }

        .bingo-square.rapid-flash::before {
            animation: rapid-flash 0.1s infinite;
        }

        /* Confetti styles */
        .confetti-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1500;
            overflow: hidden;
        }

        .confetti-piece {
            position: absolute;
            width: 18px;
            height: 18px;
            background: #FFD700;
            animation: confetti-fall linear infinite;
        }

        .confetti-piece:nth-child(2n) {
            background: #FF6B6B;
            width: 15px;
            height: 24px;
        }

        .confetti-piece:nth-child(3n) {
            background: #4ECDC4;
            width: 22px;
            height: 15px;
        }

        .confetti-piece:nth-child(4n) {
            background: #45B7D1;
            width: 20px;
            height: 20px;
            border-radius: 50%;
        }

        .confetti-piece:nth-child(5n) {
            background: #96CEB4;
            width: 25px;
            height: 12px;
        }

        .confetti-piece:nth-child(6n) {
            background: #FFEAA7;
            width: 12px;
            height: 22px;
        }

        .confetti-piece:nth-child(7n) {
            background: #DDA0DD;
            width: 16px;
            height: 16px;
            border-radius: 50%;
        }

        @keyframes confetti-fall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        .pause-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            color: white;
        }

        .pause-button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 20px 40px;
            font-size: clamp(1.2rem, 4vw, 2rem);
            font-weight: bold;
            border-radius: 25px;
            cursor: pointer;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
            text-transform: uppercase;
        }

        .pause-button:hover {
            background: #45a049;
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(0,0,0,0.4);
        }

        .pause-message {
            font-size: clamp(1rem, 3vw, 1.5rem);
            margin-bottom: 20px;
            text-align: center;
            opacity: 0.8;
        }

        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
        }

        .popup {
            background: white;
            color: #333;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            max-width: 90%;
            width: 350px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }

        .popup h2 {
            margin-bottom: 15px;
            color: #4CAF50;
            font-size: clamp(1.2rem, 4vw, 1.5rem);
        }

        .popup p {
            margin-bottom: 20px;
            font-size: clamp(0.9rem, 3vw, 1.1rem);
        }

        .popup-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-direction: column;
            align-items: center;
        }

        .popup-button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 20px;
            cursor: pointer;
            font-size: clamp(0.9rem, 2.5vw, 1.1rem);
            transition: all 0.3s ease;
            width: 100%;
            max-width: 250px;
        }

        .popup-button:hover {
            background: #45a049;
            transform: translateY(-2px);
        }

        .popup-button.secondary {
            background: #4CAF50;
        }

        .popup-button.secondary:hover {
            background: #45a049;
        }

        .hidden {
            display: none;
        }

        .high-score-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
            box-sizing: border-box;
            overflow-y: auto;
        }

        .high-score-screen.hidden {
            display: none;
        }

        .high-score-screen h2 {
            margin-bottom: 20px;
            font-size: clamp(1.3rem, 4vw, 2rem);
            color: white;
        }

        .score-columns {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-bottom: 20px;
            max-width: 500px;
            width: 100%;
        }

        .score-column h3 {
            margin-bottom: 10px;
            color: #FFD700;
            font-size: clamp(1rem, 3vw, 1.2rem);
        }

        .score-list {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            min-height: 150px;
            color: white;
        }

        .score-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            padding: 5px 0;
            border-bottom: 1px solid rgba(255,255,255,0.2);
            font-size: clamp(0.8rem, 2.5vw, 1rem);
        }

        .score-item:last-child {
            border-bottom: none;
        }

        .score-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        /* Larger screens */
        @media (min-width: 480px) {
            .app-container {
                padding: 15px;
            }
            
            .header {
                margin: 20px 0;
            }
            
            .bingo-card {
                gap: 3px;
                padding: 10px;
            }
            
            .bingo-square {
                padding: 5px;
                border-radius: 8px;
            }
            
            .button-container {
                gap: 15px;
                margin-bottom: 20px;
            }
            
            .play-button, .new-card-button {
                padding: 15px 30px;
                max-width: 160px;
            }
            
            .score-columns {
                grid-template-columns: 1fr 1fr;
                gap: 30px;
                margin-bottom: 30px;
            }
        }

        /* Very small screens */
        @media screen and (max-width: 360px) {
            .bingo-square {
                font-size: 0.65rem !important;
                padding: 1px;
                font-weight: bold !important;
            }
            
            .header h1 {
                font-size: 1.3rem;
            }
            
            .button-container {
                gap: 5px;
            }
            
            .play-button, .new-card-button {
                padding: 8px 12px;
                font-size: 0.8rem;
                min-width: 80px;
            }
        }

        /* Landscape phone orientation */
        @media (orientation: landscape) and (max-height: 500px) {
            .header {
                margin: 5px 0 10px 0;
            }
            
            .header h1 {
                font-size: 1.5rem;
                margin-bottom: 5px;
            }
            
            .timer-display {
                padding: 5px 10px;
                margin-bottom: 10px;
            }
            
            .button-container {
                margin-bottom: 10px;
            }
            
            .play-button, .new-card-button {
                padding: 8px 16px;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <div class="header">
            <h1>I-75 BINGO</h1>
            <div class="timer-display" id="timer">00:00</div>
            <div class="button-container">
                <button class="play-button" id="playButton">PLAY</button>
                <button class="new-card-button" id="newCardButton"><span>NEW CARD</span></button>
                <button class="new-card-button" id="sameCardButton" onclick="playAgainSameCard()" style="display:none;">PLAY AGAIN SAME CARD</button>
                <button class="new-card-button" id="highScoresButton">HIGH SCORES</button>
            </div>
        </div>

        <div class="bingo-card" id="bingoCard">
            <!-- Bingo squares will be generated here -->
        </div>

        <div class="high-score-screen hidden" id="highScoreScreen">
            <h2>🏆 High Scores 🏆</h2>
            <div class="score-columns">
                <div class="score-column">
                    <h3>Top 5 Bingo Times</h3>
                    <div class="score-list" id="bingoScores"></div>
                </div>
                <div class="score-column">
                    <h3>Top 5 Coverall Times</h3>
                    <div class="score-list" id="coverallScores"></div>
                </div>
            </div>
            <div class="score-buttons">
                <button class="popup-button" onclick="backToMainScreen()">BACK</button>
                <button class="popup-button secondary" onclick="clearResults()">Clear Results</button>
                <button class="popup-button secondary" onclick="exitApp()">Exit</button>
            </div>
        </div>
    </div>

    <!-- Pause Overlay -->
    <div class="pause-overlay hidden" id="pauseOverlay">
        <div class="pause-message">Game Paused</div>
        <button class="pause-button" id="unpauseButton">Tap to UNPAUSE</button>
    </div>

    <!-- Popup for Bingo/Coverall -->
    <div class="popup-overlay hidden" id="popupOverlay">
        <div class="popup">
            <h2 id="popupTitle">Congratulations!</h2>
            <p id="popupMessage"></p>
            <div class="popup-buttons" id="popupButtons">
                <!-- Buttons will be dynamically added -->
            </div>
        </div>
    </div>

    <script>
        // I-75 Bingo phrases
        const BINGO_PHRASES = [
            "Pleasure Boat", "Fishing Boat", "Duck<br>Hunting<br>Boat", "KAYAK", "CANOE", "DIRT BIKE",
            "4X4 ATV", "Side x Side<br>ORV", "JEEP", "EMERGENCY<br>VEHICLE", "Lawn Mower",
            "Motor Home", "DOG", "American Flag", "Vehicle Being Hauled or Towed",
            "Motorcycle", "Fedex or<br>UPS Truck", "LUMBER", "TRACTOR", "TANKER",
            "GOLF CART", "Red/Black<br>Semi Cab", "BICYCLE", "Empty Trailer",
            "BUS", "Water Tower", "Rest Area", "ROADKILL", "Vehicle on Side of Road",
            "Church", "Pickup Truck with Stuff in the Back", "ELECTRONIC<br>ROAD<br>SIGN",
            "Out of State License Plate", "Bulldozer, Excavator or Skidsteer", "Bright Yellow Vehicle"
        ];

        // Check if phrase needs emergency vehicle styling
        function needsEmergencyStyle(phrase) {
            return phrase === "EMERGENCY<br>VEHICLE";
        }

        // Special function to format emergency vehicle with better spacing and larger "VEHICLE"
        function formatEmergencyText() {
            return '<div class="emergency-word">EMERGENCY</div><div class="vehicle-word">VEHICLE</div>';
        }

        // Check if phrase needs motorcyclist styling
        function needsMotorcyclistStyle(phrase) {
            return phrase === "Motorcycle";
        }

        // Check if phrase needs programmable styling
        function needsProgrammableStyle(phrase) {
            return phrase === "ELECTRONIC<br>ROAD<br>SIGN";
        }

        // Special function to format electronic road sign with smaller "ELECTRONIC"
        function formatProgrammableText() {
            return '<div class="smaller-word">ELECTRONIC</div><div class="normal-word">ROAD</div><div class="normal-word">SIGN</div>';
        }

        // Check if phrase needs side x side styling
        function needsSideXSideStyle(phrase) {
            return phrase === "Side x Side<br>ORV";
        }

        // Check if phrase needs duck hunting boat styling
        function needsDuckHuntingStyle(phrase) {
            return phrase === "Duck<br>Hunting<br>Boat";
        }

        // Special function to format duck hunting boat with proper spacing
        function formatDuckHuntingText() {
            return '<div class="duck-word">Duck</div><div class="duck-word">Hunting</div><div class="duck-word">Boat</div>';
        }

        // Check if phrase is a short phrase that should be larger
        function isShortPhrase(phrase) {
            const shortPhrases = ["KAYAK", "CANOE", "DIRT BIKE", "4X4 ATV", "BICYCLE", "JEEP", "DOG", "LUMBER", "TANKER", "GOLF CART", "BUS", "Church", "Motor Home", "Empty Trailer", "Rest Area"];
            return shortPhrases.includes(phrase);
        }

        // Check if phrase needs semi cab styling
        function needsSemiCabStyle(phrase) {
            return phrase === "Red/Black<br>Semi Cab";
        }

        // Special function to format semi cab with proper spacing
        function formatSemiCabText() {
            return '<div class="semi-line">Red/Black</div><div class="semi-line">Semi Cab</div>';
        }

        // Game state with simple timer approach
        let gameState = {
            isPlaying: false,
            isPaused: false,
            startTime: null,
            pausedAt: 0,
            selectedSquares: new Set(),
            bingoCard: [],
            timer: null,
            newCardTimer: null,
            newCardTimeLeft: 0,
            inactivityTimer: null,
            hasBingo: false,
            hasCoverall: false,
            bingoTime: null,
            coverallTime: null
        };

        // Simple timer functions
        function startTimer() {
            console.log('*** STARTING TIMER ***');
            
            if (gameState.timer) {
                clearInterval(gameState.timer);
            }
            
            if (gameState.pausedAt > 0) {
                gameState.startTime = Date.now() - (gameState.pausedAt * 1000);
                console.log('Resuming from', gameState.pausedAt, 'seconds');
            } else {
                gameState.startTime = Date.now();
                console.log('Starting fresh');
            }
            
            updateTimer();
            
            gameState.timer = setInterval(() => {
                if (!gameState.isPaused) {
                    updateTimer();
                }
            }, 1000);
            
            console.log('Timer interval created');
        }

        function updateTimer() {
            if (!gameState.startTime) return;
            
            const seconds = Math.floor((Date.now() - gameState.startTime) / 1000);
            console.log('Timer update:', seconds);
            document.getElementById('timer').textContent = formatTime(seconds);
        }

        function pauseTimer() {
            gameState.isPaused = true;
            gameState.pausedAt = Math.floor((Date.now() - gameState.startTime) / 1000);
            console.log('Paused at', gameState.pausedAt, 'seconds');
        }

        function resumeTimer() {
            gameState.isPaused = false;
            gameState.startTime = Date.now() - (gameState.pausedAt * 1000);
            console.log('Resumed from', gameState.pausedAt, 'seconds');
        }

        function stopTimer() {
            if (gameState.timer) {
                clearInterval(gameState.timer);
                gameState.timer = null;
            }
        }

        // Audio management with single AudioContext
        let audioContext = null;

        function initAudioContext() {
            if (!audioContext && (typeof AudioContext !== 'undefined' || typeof webkitAudioContext !== 'undefined')) {
                try {
                    audioContext = new (window.AudioContext || window.webkitAudioContext)();
                } catch (e) {
                    console.warn('Audio not available');
                }
            }
        }

        const audioFiles = {
            start: { frequency: 440, duration: 0.5 },
            hit: { frequency: 880, duration: 0.2 },
            remove: { frequency: 220, duration: 0.2 },
            tada: { frequency: 660, duration: 1.0 },
            coverall: { frequency: 880, duration: 1.5 }
        };

        function createFallbackBeep(frequency, duration) {
            if (!audioContext) return;
            
            try {
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = frequency;
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + duration);
            } catch (e) {
                console.warn('Audio playback failed');
            }
        }

        function playAudio(audioKey) {
            if (!audioContext) {
                initAudioContext();
            }
            
            if (audioContext && audioFiles[audioKey]) {
                const { frequency, duration } = audioFiles[audioKey];
                createFallbackBeep(frequency, duration);
            }
        }

        function vibrate(pattern) {
            if (navigator.vibrate) {
                navigator.vibrate(pattern);
            }
        }

        // Confetti system with multiple waves
        function createConfetti() {
            // Create multiple waves of confetti over time (for bingo wins)
            createConfettiWave(0, 30);    // First wave immediately
            setTimeout(() => createConfettiWave(1, 30), 1000);  // Second wave after 1 second
            setTimeout(() => createConfettiWave(2, 30), 2500);  // Third wave after 2.5 seconds
        }

        // Enhanced fireworks system for coverall
        function createFireworks() {
            // Create multiple simultaneous firework bursts for maximum impact
            createSimultaneousFireworks(0);
            setTimeout(() => createSimultaneousFireworks(1), 800);
            setTimeout(() => createSimultaneousFireworks(2), 1600);
            setTimeout(() => createSimultaneousFireworks(3), 2400);
            setTimeout(() => createSimultaneousFireworks(4), 3200);
        }

        function createSimultaneousFireworks(waveNumber) {
            // Launch multiple fireworks at the same time
            createFireworkBurst(waveNumber * 4, 'chrysanthemum');
            createFireworkBurst(waveNumber * 4 + 1, 'willow');
            createFireworkBurst(waveNumber * 4 + 2, 'ring');
            createFireworkBurst(waveNumber * 4 + 3, 'crossette');
        }

        function createFireworkBurst(burstNumber, type) {
            let fireworksContainer = document.getElementById('fireworksContainer');
            
            // Create container if it doesn't exist
            if (!fireworksContainer) {
                fireworksContainer = document.createElement('div');
                fireworksContainer.className = 'confetti-container';
                fireworksContainer.id = 'fireworksContainer';
                document.body.appendChild(fireworksContainer);
            }

            // Random burst center position
            const centerX = Math.random() * (window.innerWidth - 300) + 150;
            const centerY = Math.random() * (window.innerHeight - 400) + 100;

            // Different firework types with varying particle counts
            let particleCount, colors, size;
            
            switch(type) {
                case 'chrysanthemum':
                    particleCount = 40;
                    colors = ['#FFD700', '#FFA500', '#FF6347', '#FF1493', '#FF4500'];
                    size = { min: 4, max: 8 };
                    break;
                case 'willow':
                    particleCount = 35;
                    colors = ['#32CD32', '#00FF00', '#7FFF00', '#ADFF2F', '#9AFF9A'];
                    size = { min: 3, max: 6 };
                    break;
                case 'ring':
                    particleCount = 30;
                    colors = ['#4169E1', '#0000FF', '#6495ED', '#00BFFF', '#87CEEB'];
                    size = { min: 5, max: 9 };
                    break;
                case 'crossette':
                    particleCount = 50;
                    colors = ['#FF69B4', '#FF1493', '#DA70D6', '#BA55D3', '#9370DB'];
                    size = { min: 4, max: 7 };
                    break;
            }

            // Create particles for this burst
            for (let i = 0; i < particleCount; i++) {
                const spark = document.createElement('div');
                spark.className = 'firework-spark';
                
                // Random properties
                const color = colors[Math.floor(Math.random() * colors.length)];
                const sparkSize = Math.random() * (size.max - size.min) + size.min;
                
                // Set initial styles
                spark.style.position = 'absolute';
                spark.style.left = centerX + 'px';
                spark.style.top = centerY + 'px';
                spark.style.width = sparkSize + 'px';
                spark.style.height = sparkSize + 'px';
                spark.style.background = color;
                spark.style.borderRadius = '50%';
                spark.style.pointerEvents = 'none';
                spark.style.zIndex = '1500';
                spark.style.boxShadow = `0 0 ${sparkSize * 2}px ${color}, 0 0 ${sparkSize * 4}px ${color}`;
                
                fireworksContainer.appendChild(spark);
                
                // Animate spark explosion based on type
                animateFireworkSpark(spark, centerX, centerY, i, type, particleCount);
            }
        }

        function animateFireworkSpark(spark, centerX, centerY, index, type, totalParticles) {
            const startTime = performance.now();
            const duration = 3000 + Math.random() * 2000; // 3-5 seconds
            
            let angle, velocity, gravity = 200;
            
            // Different explosion patterns based on firework type
            switch(type) {
                case 'chrysanthemum':
                    angle = (index / totalParticles) * Math.PI * 2 + (Math.random() - 0.5) * 0.3;
                    velocity = Math.random() * 200 + 150;
                    break;
                case 'willow':
                    angle = (index / totalParticles) * Math.PI * 2 + (Math.random() - 0.5) * 0.5;
                    velocity = Math.random() * 120 + 80;
                    gravity = 300; // Falls faster like willow branches
                    break;
                case 'ring':
                    angle = (index / totalParticles) * Math.PI * 2;
                    velocity = 180 + Math.random() * 40; // More uniform velocity
                    break;
                case 'crossette':
                    if (index < totalParticles / 2) {
                        angle = (index / (totalParticles / 2)) * Math.PI * 2;
                        velocity = Math.random() * 100 + 120;
                    } else {
                        // Secondary explosion
                        angle = ((index - totalParticles / 2) / (totalParticles / 2)) * Math.PI * 2;
                        velocity = Math.random() * 80 + 60;
                        setTimeout(() => {
                            // Delayed secondary sparks
                            createSecondarySpark(spark, centerX, centerY, angle, velocity * 0.6);
                        }, 800);
                    }
                    break;
            }
            
            function animate(currentTime) {
                const elapsed = currentTime - startTime;
                
                if (elapsed >= duration) {
                    // Animation complete
                    if (spark.parentNode) {
                        spark.parentNode.removeChild(spark);
                    }
                    return;
                }
                
                const progress = elapsed / duration;
                const t = elapsed / 1000; // time in seconds
                
                // Enhanced physics with air resistance
                const airResistance = 0.99;
                const currentVelocity = velocity * Math.pow(airResistance, elapsed / 50);
                
                const currentX = centerX + Math.cos(angle) * currentVelocity * t;
                const currentY = centerY + Math.sin(angle) * currentVelocity * t + 0.5 * gravity * t * t;
                
                spark.style.left = currentX + 'px';
                spark.style.top = currentY + 'px';
                
                // Enhanced fading and twinkling effect
                const twinkle = 0.8 + 0.2 * Math.sin(elapsed / 100);
                spark.style.opacity = (1 - progress * 0.7) * twinkle;
                
                // Scale effect
                const scale = 1 + progress * 0.5;
                spark.style.transform = `scale(${scale})`;
                
                requestAnimationFrame(animate);
            }
            
            requestAnimationFrame(animate);
        }

        function createSecondarySpark(originalSpark, startX, startY, angle, velocity) {
            const spark = document.createElement('div');
            spark.className = 'firework-spark';
            
            // Smaller secondary sparks
            const size = 3;
            const color = '#FFFFFF';
            
            spark.style.position = 'absolute';
            spark.style.left = startX + 'px';
            spark.style.top = startY + 'px';
            spark.style.width = size + 'px';
            spark.style.height = size + 'px';
            spark.style.background = color;
            spark.style.borderRadius = '50%';
            spark.style.pointerEvents = 'none';
            spark.style.zIndex = '1500';
            spark.style.boxShadow = `0 0 ${size * 3}px ${color}`;
            
            const container = document.getElementById('fireworksContainer');
            if (container) {
                container.appendChild(spark);
                animateFireworkSpark(spark, startX, startY, 0, 'chrysanthemum', 1);
            }
        }
        
        function createConfettiWave(waveNumber, count) {
            let confettiContainer = document.getElementById('confettiContainer');
            
            // Create container if it doesn't exist
            if (!confettiContainer) {
                confettiContainer = document.createElement('div');
                confettiContainer.className = 'confetti-container';
                confettiContainer.id = 'confettiContainer';
                document.body.appendChild(confettiContainer);
            }

            // Create confetti pieces for this wave
            for (let i = 0; i < count; i++) {
                const piece = document.createElement('div');
                piece.className = 'confetti-piece';
                
                // Random starting position
                const startX = Math.random() * window.innerWidth;
                const startY = -30; // Start above screen
                
                // Random properties
                const colors = ['#FFD700', '#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEAA7', '#DDA0DD'];
                const color = colors[Math.floor(Math.random() * colors.length)];
                const size = Math.random() * 10 + 12; // 12-22px
                const isCircle = Math.random() < 0.3;
                
                // Set initial styles
                piece.style.position = 'absolute';
                piece.style.left = startX + 'px';
                piece.style.top = startY + 'px';
                piece.style.width = size + 'px';
                piece.style.height = size + 'px';
                piece.style.background = color;
                piece.style.pointerEvents = 'none';
                piece.style.zIndex = '1500';
                if (isCircle) piece.style.borderRadius = '50%';
                
                confettiContainer.appendChild(piece);
                
                // Start animation immediately with JavaScript
                const uniqueIndex = waveNumber * count + i;
                animateConfettiPiece(piece, startX, startY, uniqueIndex);
            }
        }
        
        function animateConfettiPiece(piece, startX, startY, index) {
            const startTime = performance.now();
            const duration = (Math.random() * 4 + 6) * 1000; // 6-10 seconds in milliseconds
            const delay = index < 20 ? 0 : Math.random() * 300; // Most pieces start quickly
            const endY = window.innerHeight + 50;
            const drift = (Math.random() - 0.5) * 200; // horizontal drift
            
            function animate(currentTime) {
                const elapsed = currentTime - startTime - delay;
                
                if (elapsed < 0) {
                    // Still in delay period
                    requestAnimationFrame(animate);
                    return;
                }
                
                if (elapsed >= duration) {
                    // Animation complete
                    if (piece.parentNode) {
                        piece.parentNode.removeChild(piece);
                    }
                    return;
                }
                
                const progress = elapsed / duration;
                const currentY = startY + (endY - startY) * progress;
                const currentX = startX + drift * progress;
                const rotation = progress * 360;
                
                piece.style.transform = `translate(${currentX - startX}px, ${currentY - startY}px) rotate(${rotation}deg)`;
                piece.style.opacity = 1 - progress * 0.3; // Fade out slowly
                
                requestAnimationFrame(animate);
            }
            
            requestAnimationFrame(animate);
        }

        function removeConfetti() {
            const confettiContainer = document.getElementById('confettiContainer');
            if (confettiContainer) {
                confettiContainer.remove();
            }
            
            const fireworksContainer = document.getElementById('fireworksContainer');
            if (fireworksContainer) {
                fireworksContainer.remove();
            }
        }

        function formatTime(seconds) {
            if (isNaN(seconds) || seconds < 0) return '00:00';
            
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }

        function startNewCardCountdown() {
            console.log('Starting NEW CARD countdown timer');
            
            if (gameState.newCardTimer) {
                clearInterval(gameState.newCardTimer);
            }
            
            gameState.newCardTimeLeft = 15;
            updateNewCardButton();
            
            gameState.newCardTimer = setInterval(() => {
                gameState.newCardTimeLeft--;
                updateNewCardButton();
                
                if (gameState.newCardTimeLeft <= 0) {
                    stopNewCardCountdown();
                }
            }, 1000);
        }

        function stopNewCardCountdown() {
            console.log('Stopping NEW CARD countdown timer');
            
            if (gameState.newCardTimer) {
                clearInterval(gameState.newCardTimer);
                gameState.newCardTimer = null;
            }
            
            gameState.newCardTimeLeft = 0;
            updateNewCardButton();
        }

        function updateNewCardButton() {
            const newCardButton = document.getElementById('newCardButton');
            const buttonSpan = newCardButton.querySelector('span');
            
            if (gameState.newCardTimeLeft > 0 && gameState.selectedSquares.size <= 1) {
                const percentageRemaining = (gameState.newCardTimeLeft / 15) * 100;
                
                newCardButton.style.background = '#4CAF50';
                
                const styleSheet = document.createElement('style');
                styleSheet.textContent = `
                    #newCardButton::before {
                        width: ${percentageRemaining}% !important;
                    }
                `;
                
                const existingStyle = document.getElementById('countdown-style');
                if (existingStyle) {
                    existingStyle.remove();
                }
                
                styleSheet.id = 'countdown-style';
                document.head.appendChild(styleSheet);
                
                buttonSpan.textContent = 'NEW CARD';
                newCardButton.disabled = false;
            } else {
                const styleSheet = document.createElement('style');
                styleSheet.textContent = `
                    #newCardButton::before {
                        width: 0% !important;
                    }
                `;
                
                const existingStyle = document.getElementById('countdown-style');
                if (existingStyle) {
                    existingStyle.remove();
                }
                
                styleSheet.id = 'countdown-style';
                document.head.appendChild(styleSheet);
                
                if (gameState.isPlaying) {
                    newCardButton.style.background = '#4CAF50';
                    buttonSpan.textContent = 'NEW CARD';
                    newCardButton.disabled = true;
                } else {
                    newCardButton.style.background = '#2196F3';
                    buttonSpan.textContent = 'NEW CARD';
                    newCardButton.disabled = false;
                }
            }
        }

        function startGame() {
            const playButton = document.getElementById('playButton');
            
            if (playButton.textContent === 'CONTINUE FOR COVERALL') {
                gameState.isPlaying = true;
                gameState.isPaused = false;
                
                startTimer();
                
                playButton.disabled = true;
                playButton.textContent = 'Playing for Coverall...';
                document.getElementById('newCardButton').disabled = true;
                document.getElementById('sameCardButton').style.display = 'none';
                document.getElementById('highScoresButton').disabled = true;
                
                updateCardState();
            } else {
                resetGameState();
                
                gameState.selectedSquares.clear();
                gameState.selectedSquares.add(12);
                
                const squares = document.querySelectorAll('.bingo-square');
                squares.forEach((square, index) => {
                    if (index === 12) {
                        square.classList.add('selected');
                    } else {
                        square.classList.remove('selected');
                    }
                });
                
                gameState.isPlaying = true;
                gameState.pausedAt = 0;
                
                playButton.disabled = true;
                playButton.textContent = 'Playing...';
                document.getElementById('sameCardButton').style.display = 'none';
                document.getElementById('highScoresButton').disabled = true;
                
                startNewCardCountdown();
                
                playAudio('start');
                startTimer();
                updateCardState();
            }
            
            resetInactivityTimer();
        }

        function resetGameState() {
            gameState.isPlaying = false;
            gameState.isPaused = false;
            gameState.startTime = null;
            gameState.pausedAt = 0;
            gameState.hasBingo = false;
            gameState.hasCoverall = false;
            gameState.bingoTime = null;
            gameState.coverallTime = null;
            stopTimer();
            stopNewCardCountdown();
        }

        function updateCardState() {
            const squares = document.querySelectorAll('.bingo-square');
            squares.forEach(square => {
                square.classList.remove('disabled', 'pre-game');
                
                if (!gameState.isPlaying && !gameState.hasBingo) {
                    square.classList.add('pre-game');
                } else if (gameState.isPlaying && !gameState.isPaused) {
                    // Game is actively playing - squares are interactive
                } else {
                    square.classList.add('disabled');
                }
            });
        }

        function addPauseFunctionality(freeSquare) {
            let touchStartTime = 0;
            let holdTimer = null;
            
            function startHold() {
                if (!gameState.isPlaying || gameState.isPaused) return;
                
                touchStartTime = Date.now();
                
                freeSquare.classList.add('hold-to-pause');
                
                holdTimer = setTimeout(() => {
                    pauseGame();
                    freeSquare.classList.remove('hold-to-pause');
                }, 5000);
            }
            
            function endHold() {
                if (holdTimer) {
                    clearTimeout(holdTimer);
                    holdTimer = null;
                }
                freeSquare.classList.remove('hold-to-pause');
            }
            
            freeSquare.addEventListener('mousedown', startHold);
            freeSquare.addEventListener('mouseup', endHold);
            freeSquare.addEventListener('mouseleave', endHold);
            
            freeSquare.addEventListener('touchstart', (e) => {
                e.preventDefault();
                startHold();
            });
            
            freeSquare.addEventListener('touchend', (e) => {
                e.preventDefault();
                endHold();
            });
            
            freeSquare.addEventListener('touchcancel', (e) => {
                e.preventDefault();
                endHold();
            });
        }

        function pauseGame() {
            pauseTimer();
            document.getElementById('pauseOverlay').classList.remove('hidden');
            vibrate([200, 100, 200]);
            updateCardState();
        }

        function unpauseGame() {
            resumeTimer();
            document.getElementById('pauseOverlay').classList.add('hidden');
            vibrate([100, 50, 100]);
            updateCardState();
            resetInactivityTimer();
        }

        async function generateBingoCard() {
            const card = document.getElementById('bingoCard');
            card.innerHTML = '';
            gameState.bingoCard = [];
            gameState.selectedSquares.clear();

            const shuffledPhrases = [...BINGO_PHRASES].sort(() => Math.random() - 0.5);
            
            for (let i = 0; i < 25; i++) {
                const square = document.createElement('div');
                square.className = 'bingo-square';
                square.dataset.index = i;
                
                if (i === 12) {
                    const span = document.createElement('span');
                    span.textContent = 'FREE';
                    square.appendChild(span);
                    square.classList.add('free');
                    gameState.selectedSquares.add(i);
                    
                    addPauseFunctionality(square);
                } else {
                    const phrase = shuffledPhrases[i < 12 ? i : i - 1];
                    const span = document.createElement('span');
                    
                    // Apply larger font size for short phrases
                    if (isShortPhrase(phrase)) {
                        square.classList.add('short-phrase');
                    }
                    
                    // Apply duck hunting styling
                    if (needsDuckHuntingStyle(phrase)) {
                        square.classList.add('duck-hunting-style');
                        span.innerHTML = formatDuckHuntingText();
                    }
                    // Apply emergency styling
                    else if (needsEmergencyStyle(phrase)) {
                        square.classList.add('emergency-style');
                        span.innerHTML = formatEmergencyText();
                    }
                    // Apply motorcyclist styling
                    else if (needsMotorcyclistStyle(phrase)) {
                        // Now using default styling like Pleasure Boat
                        span.innerHTML = phrase;
                    }
                    // Apply side x side styling
                    else if (needsSideXSideStyle(phrase)) {
                        square.classList.add('side-x-side-style');
                        span.innerHTML = phrase;
                    }
                    // Apply programmable styling
                    else if (needsProgrammableStyle(phrase)) {
                        square.classList.add('programmable-style');
                        span.innerHTML = formatProgrammableText();
                    } else {
                        span.innerHTML = phrase;
                    }
                    
                    square.appendChild(span);
                    square.addEventListener('click', () => toggleSquare(i));
                }
                
                card.appendChild(square);
                gameState.bingoCard.push(square);
            }
            
            updateCardState();
        }

        function toggleSquare(index) {
            if (!gameState.isPlaying || gameState.isPaused || index === 12) return;
            
            if (gameState.newCardTimeLeft > 0 && gameState.selectedSquares.size === 1) {
                stopNewCardCountdown();
                vibrate([100, 50, 100]);
            }
            
            const square = gameState.bingoCard[index];
            const wasSelected = gameState.selectedSquares.has(index);
            
            if (wasSelected) {
                gameState.selectedSquares.delete(index);
                square.classList.remove('selected');
                playAudio('remove');
                vibrate(50);
            } else {
                gameState.selectedSquares.add(index);
                square.classList.add('selected');
                playAudio('hit');
                vibrate(75);
            }
            
            resetInactivityTimer();
            checkForWin();
        }

        function checkForWin() {
            const selected = gameState.selectedSquares;
            
            if (selected.size === 25 && !gameState.hasCoverall) {
                // Start fireworks immediately when coverall is first detected
                createFireworks();
                console.log('Fireworks should be starting NOW!');
                
                gameState.hasCoverall = true;
                
                const elapsed = Math.floor((Date.now() - gameState.startTime) / 1000);
                
                gameState.isPlaying = false;
                stopTimer();
                playAudio('coverall');
                
                // Start rapid random flashing for 2 seconds
                let flashCount = 0;
                const maxFlashes = 20; // 2 seconds at 100ms intervals
                
                const randomFlash = setInterval(() => {
                    // Remove all rapid-flash classes first
                    gameState.bingoCard.forEach(square => {
                        square.classList.remove('rapid-flash');
                    });
                    
                    // Flash 3-5 random squares
                    const numToFlash = Math.floor(Math.random() * 3) + 3;
                    const squaresToFlash = [];
                    
                    while (squaresToFlash.length < numToFlash) {
                        const randomIndex = Math.floor(Math.random() * 25);
                        if (!squaresToFlash.includes(randomIndex)) {
                            squaresToFlash.push(randomIndex);
                        }
                    }
                    
                    squaresToFlash.forEach(index => {
                        gameState.bingoCard[index].classList.add('rapid-flash');
                    });
                    
                    // Vibrate pulse for each flash
                    vibrate(50);
                    
                    flashCount++;
                    
                    if (flashCount >= maxFlashes) {
                        clearInterval(randomFlash);
                        
                        // Remove all rapid-flash classes
                        gameState.bingoCard.forEach(square => {
                            square.classList.remove('rapid-flash');
                        });
                        
                        // Start synchronized blinking of all squares
                        gameState.bingoCard.forEach(square => {
                            square.classList.add('bingo-winner');
                        });
                        
                        // Single coordinated vibration pattern that lasts exactly 5 seconds (5000ms total)
                        // Maximum intensity pattern - 800ms vibrate, 200ms pause
                        vibrate([800, 200, 800, 200, 800, 200, 800, 200, 800]);
                        
                        // Stop blinking after 5 seconds and show popup
                        setTimeout(() => {
                            gameState.bingoCard.forEach(square => {
                                square.classList.remove('bingo-winner');
                            });
                            showCoverallPopup(elapsed);
                        }, 5000);
                    }
                }, 100);
                
                return;
            }
            
            if (!gameState.hasBingo && checkBingo(selected)) {
                gameState.hasBingo = true;
                gameState.bingoTime = Math.floor((Date.now() - gameState.startTime) / 1000);
                
                const winningPattern = checkBingo(selected);
                
                gameState.isPlaying = false;
                pauseTimer();
                playAudio('tada');
                
                // Add confetti for bingo win
                createConfetti();
                
                updateCardState();
                
                // Blink the winning squares
                winningPattern.forEach(index => {
                    const square = gameState.bingoCard[index];
                    square.classList.add('bingo-winner');
                });
                
                // Add steady vibration for bingo blinking
                let vibrateCount = 0;
                const bingoVibrate = setInterval(() => {
                    vibrate(100);
                    vibrateCount++;
                    if (vibrateCount >= 10) { // Stop after 10 vibrations (5 seconds)
                        clearInterval(bingoVibrate);
                    }
                }, 500);
                
                // Stop blinking after 5 seconds and show popup
                setTimeout(() => {
                    winningPattern.forEach(index => {
                        const square = gameState.bingoCard[index];
                        square.classList.remove('bingo-winner');
                    });
                    showBingoPopup(gameState.bingoTime);
                }, 5000);
            }
        }

        function checkBingo(selected) {
            const patterns = [
                [0, 1, 2, 3, 4], [5, 6, 7, 8, 9], [10, 11, 12, 13, 14],
                [15, 16, 17, 18, 19], [20, 21, 22, 23, 24],
                [0, 5, 10, 15, 20], [1, 6, 11, 16, 21], [2, 7, 12, 17, 22],
                [3, 8, 13, 18, 23], [4, 9, 14, 19, 24],
                [0, 6, 12, 18, 24], [4, 8, 12, 16, 20]
            ];
            
            for (const pattern of patterns) {
                if (pattern.every(index => selected.has(index))) {
                    return pattern; // Return the winning pattern
                }
            }
            return null;
        }

        function showBingoPopup(elapsed) {
            document.getElementById('popupTitle').textContent = 'Congratulations!';
            document.getElementById('popupMessage').textContent = `You got Bingo in ${formatTime(elapsed)}!`;
            
            const buttonsContainer = document.getElementById('popupButtons');
            buttonsContainer.innerHTML = `
                <button class="popup-button secondary" onclick="playAgainNoCramble()">Play Again</button>
                <button class="popup-button" onclick="continueForCoverall()">Continue for Coverall</button>
                <button class="popup-button secondary" onclick="showHighScores()">View High Scores</button>
            `;
            
            document.getElementById('popupOverlay').classList.remove('hidden');
            
            vibrate([100, 50, 100, 50, 100]);
            
            saveScore('bingo', elapsed);
        }

        function showCoverallPopup(elapsed) {
            const bingoElapsed = gameState.bingoTime || 0;
            
            document.getElementById('popupTitle').textContent = 'Congratulations on Coverall!';
            document.getElementById('popupMessage').innerHTML = `
                Bingo Time: ${formatTime(bingoElapsed)}<br>
                Coverall Time: ${formatTime(elapsed)}
            `;
            
            const buttonsContainer = document.getElementById('popupButtons');
            buttonsContainer.innerHTML = `
                <button class="popup-button" onclick="playAgainNoCramble()">Play Again</button>
                <button class="popup-button secondary" onclick="showHighScores()">View High Scores</button>
            `;
            
            document.getElementById('popupOverlay').classList.remove('hidden');
            
            // No additional vibration - the coordinated pattern should end naturally
            
            if (bingoElapsed > 0) {
                saveScore('bingo', bingoElapsed);
            }
            saveScore('coverall', elapsed);
        }

        function continueForCoverall() {
            document.getElementById('popupOverlay').classList.add('hidden');
            
            gameState.isPlaying = true;
            gameState.isPaused = false;
            
            startTimer();
            
            document.getElementById('playButton').disabled = true;
            document.getElementById('playButton').textContent = 'Playing for Coverall...';
            document.getElementById('newCardButton').disabled = true;
            document.getElementById('sameCardButton').style.display = 'none';
            document.getElementById('highScoresButton').disabled = true;
            
            updateCardState();
            resetInactivityTimer();
        }

        function playAgainNoCramble() {
            document.getElementById('popupOverlay').classList.add('hidden');
            document.getElementById('highScoreScreen').classList.add('hidden');
            
            // Clean up confetti
            removeConfetti();
            
            resetGameState();
            
            gameState.selectedSquares.clear();
            gameState.selectedSquares.add(12);
            
            const squares = document.querySelectorAll('.bingo-square');
            squares.forEach((square, index) => {
                if (index === 12) {
                    square.classList.add('selected');
                } else {
                    square.classList.remove('selected');
                }
            });
            
            document.getElementById('playButton').disabled = false;
            document.getElementById('playButton').textContent = 'PLAY';
            document.getElementById('newCardButton').disabled = false;
            document.getElementById('sameCardButton').style.display = 'none';
            document.getElementById('highScoresButton').disabled = false;
            document.getElementById('timer').textContent = '00:00';
            
            updateCardState();
            resetInactivityTimer();
        }

        async function generateNewCard() {
            if (gameState.isPlaying && gameState.newCardTimeLeft > 0) {
                gameState.selectedSquares.clear();
                gameState.selectedSquares.add(12);
                
                const card = document.getElementById('bingoCard');
                card.innerHTML = '';
                gameState.bingoCard = [];

                const shuffledPhrases = [...BINGO_PHRASES].sort(() => Math.random() - 0.5);
                
                for (let i = 0; i < 25; i++) {
                    const square = document.createElement('div');
                    square.className = 'bingo-square';
                    square.dataset.index = i;
                    
                    if (i === 12) {
                        const span = document.createElement('span');
                        span.textContent = 'FREE';
                        square.appendChild(span);
                        square.classList.add('free', 'selected');
                        addPauseFunctionality(square);
                    } else {
                        const phrase = shuffledPhrases[i < 12 ? i : i - 1];
                        const span = document.createElement('span');
                        
                        // Apply larger font size for short phrases
                        if (isShortPhrase(phrase)) {
                            square.classList.add('short-phrase');
                        }
                        
                        // Apply duck hunting styling
                        if (needsDuckHuntingStyle(phrase)) {
                            square.classList.add('duck-hunting-style');
                            span.innerHTML = formatDuckHuntingText();
                        }
                        // Apply emergency styling
                        else if (needsEmergencyStyle(phrase)) {
                            square.classList.add('emergency-style');
                            span.innerHTML = formatEmergencyText();
                        }
                        // Apply motorcyclist styling
                        else if (needsMotorcyclistStyle(phrase)) {
                            // Now using default styling like Pleasure Boat
                            span.innerHTML = phrase;
                        }
                        // Apply side x side styling
                        else if (needsSideXSideStyle(phrase)) {
                            square.classList.add('side-x-side-style');
                            span.innerHTML = phrase;
                        }
                        // Apply programmable styling
                        else if (needsProgrammableStyle(phrase)) {
                            square.classList.add('programmable-style');
                            span.innerHTML = formatProgrammableText();
                        } else {
                            span.innerHTML = phrase;
                        }
                        
                        square.appendChild(span);
                        square.addEventListener('click', () => toggleSquare(i));
                    }
                    
                    card.appendChild(square);
                    gameState.bingoCard.push(square);
                }
                
                updateCardState();
            } else if (!gameState.isPlaying) {
                resetGameState();
                document.getElementById('playButton').textContent = 'PLAY';
                document.getElementById('sameCardButton').style.display = 'none';
                document.getElementById('timer').textContent = '00:00';
                
                await generateBingoCard();
                updateNewCardButton();
            }
            
            resetInactivityTimer();
        }

        function playAgainSameCard() {
            if (gameState.isPlaying) return;
            
            resetGameState();
            
            gameState.selectedSquares.clear();
            gameState.selectedSquares.add(12);
            
            const squares = document.querySelectorAll('.bingo-square');
            squares.forEach((square, index) => {
                if (index === 12) {
                    square.classList.add('selected');
                } else {
                    square.classList.remove('selected');
                }
            });
            
            document.getElementById('playButton').textContent = 'PLAY';
            document.getElementById('sameCardButton').style.display = 'none';
            document.getElementById('timer').textContent = '00:00';
            
            updateCardState();
            resetInactivityTimer();
            
            startGame();
        }

        let tempScores = { bingo: [], coverall: [] };

        function isLocalStorageAvailable() {
            try {
                const test = 'test';
                localStorage.setItem(test, test);
                localStorage.removeItem(test);
                return true;
            } catch (e) {
                return false;
            }
        }

        function saveScore(type, time) {
            if (time === null || time === undefined) return;
            
            const now = new Date();
            const timeString = now.toLocaleTimeString([], { 
                hour: 'numeric', 
                minute: '2-digit',
                hour12: true 
            });
            
            const newScore = {
                time: time,
                date: timeString
            };
            
            if (isLocalStorageAvailable()) {
                const scores = JSON.parse(localStorage.getItem(`i75Bingo_${type}Scores`) || '[]');
                scores.push(newScore);
                scores.sort((a, b) => a.time - b.time);
                const topScores = scores.slice(0, 5);
                localStorage.setItem(`i75Bingo_${type}Scores`, JSON.stringify(topScores));
            } else {
                tempScores[type].push(newScore);
                tempScores[type].sort((a, b) => a.time - b.time);
                tempScores[type] = tempScores[type].slice(0, 5);
            }
        }

        function loadHighScores() {
            let bingoScores, coverallScores;
            
            if (isLocalStorageAvailable()) {
                bingoScores = JSON.parse(localStorage.getItem('i75Bingo_bingoScores') || '[]');
                coverallScores = JSON.parse(localStorage.getItem('i75Bingo_coverallScores') || '[]');
            } else {
                bingoScores = tempScores.bingo;
                coverallScores = tempScores.coverall;
            }
            
            displayScores('bingoScores', bingoScores);
            displayScores('coverallScores', coverallScores);
        }

        function displayScores(elementId, scores) {
            const container = document.getElementById(elementId);
            container.innerHTML = '';
            
            if (scores.length === 0) {
                container.innerHTML = '<div class="score-item">No scores yet</div>';
                return;
            }
            
            scores.forEach((score, index) => {
                const item = document.createElement('div');
                item.className = 'score-item';
                item.innerHTML = `
                    <span>#${index + 1} - ${formatTime(score.time)}</span>
                    <span>${score.date}</span>
                `;
                container.appendChild(item);
            });
        }

        function showHighScores() {
            document.getElementById('popupOverlay').classList.add('hidden');
            
            // Clean up confetti when viewing high scores
            removeConfetti();
            
            loadHighScores();
            document.getElementById('highScoreScreen').classList.remove('hidden');
        }

        function backToMainScreen() {
            document.getElementById('highScoreScreen').classList.add('hidden');
            
            if (gameState.hasBingo && !gameState.hasCoverall) {
                document.getElementById('timer').textContent = formatTime(gameState.bingoTime || 0);
                
                document.getElementById('playButton').disabled = false;
                document.getElementById('playButton').textContent = 'CONTINUE FOR COVERALL';
                document.getElementById('newCardButton').disabled = false;
                document.getElementById('sameCardButton').style.display = 'block';
                document.getElementById('highScoresButton').disabled = false;
                
                updateCardState();
            } else {
                resetGameState();
                document.getElementById('playButton').disabled = false;
                document.getElementById('playButton').textContent = 'PLAY';
                document.getElementById('newCardButton').disabled = false;
                document.getElementById('sameCardButton').style.display = 'none';
                document.getElementById('highScoresButton').disabled = false;
                document.getElementById('timer').textContent = '00:00';
            }
        }

        function clearResults() {
            document.getElementById('popupTitle').textContent = 'Clear High Scores';
            document.getElementById('popupMessage').textContent = 'Are you sure you want to clear all high scores? This cannot be undone.';
            
            const buttonsContainer = document.getElementById('popupButtons');
            buttonsContainer.innerHTML = `
                <button class="popup-button" onclick="confirmClearResults()">YES, CLEAR ALL</button>
                <button class="popup-button secondary" onclick="cancelClearResults()">CANCEL</button>
            `;
            
            document.getElementById('popupOverlay').classList.remove('hidden');
        }

        function confirmClearResults() {
            document.getElementById('popupOverlay').classList.add('hidden');
            
            if (isLocalStorageAvailable()) {
                localStorage.removeItem('i75Bingo_bingoScores');
                localStorage.removeItem('i75Bingo_coverallScores');
            } else {
                tempScores.bingo = [];
                tempScores.coverall = [];
            }
            
            displayScores('bingoScores', []);
            displayScores('coverallScores', []);
            
            alert('All high scores have been cleared!');
        }

        function cancelClearResults() {
            document.getElementById('popupOverlay').classList.add('hidden');
        }

        function exitApp() {
            if (confirm('Are you sure you want to exit?')) {
                window.close();
            }
        }

        function resetInactivityTimer() {
            if (gameState.inactivityTimer) {
                clearTimeout(gameState.inactivityTimer);
            }
            
            if (!document.getElementById('highScoreScreen').classList.contains('hidden')) {
                return;
            }
            
            gameState.inactivityTimer = setTimeout(() => {
                if (gameState.isPlaying) {
                    showHighScores();
                }
            }, 60000);
        }

        async function initGame() {
            await generateBingoCard();
            loadHighScores();
            document.getElementById('playButton').addEventListener('click', startGame);
            document.getElementById('newCardButton').addEventListener('click', generateNewCard);
            document.getElementById('highScoresButton').addEventListener('click', showHighScores);
            document.getElementById('unpauseButton').addEventListener('click', unpauseGame);
            resetInactivityTimer();
        }

        // Global functions for HTML onclick handlers
        window.continueForCoverall = continueForCoverall;
        window.playAgainNoCramble = playAgainNoCramble;
        window.showHighScores = showHighScores;
        window.backToMainScreen = backToMainScreen;
        window.clearResults = clearResults;
        window.confirmClearResults = confirmClearResults;
        window.cancelClearResults = cancelClearResults;
        window.exitApp = exitApp;
        window.playAgainSameCard = playAgainSameCard;

        // PWA Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register(
                    'data:application/javascript;base64,' + btoa(`
                        const CACHE_NAME = 'i75-bingo-v1';
                        const urlsToCache = [
                            '/',
                            'data:application/javascript'
                        ];

                        self.addEventListener('install', function(event) {
                            event.waitUntil(
                                caches.open(CACHE_NAME)
                                    .then(function(cache) {
                                        return cache.addAll(urlsToCache);
                                    })
                            );
                        });

                        self.addEventListener('fetch', function(event) {
                            event.respondWith(
                                caches.match(event.request)
                                    .then(function(response) {
                                        if (response) {
                                            return response;
                                        }
                                        return fetch(event.request);
                                    }
                                )
                            );
                        });
                    `)
                ).then(function(registration) {
                    console.log('PWA Service Worker registered:', registration);
                }).catch(function(error) {
                    console.log('PWA Service Worker registration failed:', error);
                });
            });
        }

        // PWA Install Prompt
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', function(e) {
            console.log('PWA install prompt triggered');
            e.preventDefault();
            deferredPrompt = e;
            showInstallBanner();
        });

        function showInstallBanner() {
            const installBanner = document.createElement('div');
            installBanner.id = 'installBanner';
            installBanner.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                background: linear-gradient(135deg, #4CAF50, #45a049);
                color: white;
                padding: 10px;
                text-align: center;
                z-index: 3000;
                box-shadow: 0 2px 10px rgba(0,0,0,0.3);
                transform: translateY(-100%);
                transition: transform 0.3s ease;
            `;
            installBanner.innerHTML = `
                <div style="display: flex; align-items: center; justify-content: center; gap: 10px; flex-wrap: wrap;">
                    <span style="font-size: 14px; font-weight: bold;">📱 Install I-75 Bingo as an app!</span>
                    <button onclick="installPWA()" style="background: white; color: #4CAF50; border: none; padding: 8px 16px; border-radius: 20px; font-weight: bold; cursor: pointer;">Install</button>
                    <button onclick="closeInstallBanner()" style="background: transparent; color: white; border: 1px solid white; padding: 6px 12px; border-radius: 15px; cursor: pointer;">Later</button>
                </div>
            `;
            document.body.appendChild(installBanner);
            
            // Animate in
            setTimeout(() => {
                installBanner.style.transform = 'translateY(0)';
            }, 100);
        }

        window.installPWA = function() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then(function(choiceResult) {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('PWA installed');
                    }
                    deferredPrompt = null;
                    closeInstallBanner();
                });
            }
        };

        window.closeInstallBanner = function() {
            const banner = document.getElementById('installBanner');
            if (banner) {
                banner.style.transform = 'translateY(-100%)';
                setTimeout(() => banner.remove(), 300);
            }
        };

        document.addEventListener('DOMContentLoaded', initGame);
        document.addEventListener('touchstart', resetInactivityTimer);
        document.addEventListener('click', resetInactivityTimer);
    </script>
</body>
</html>
                    